<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIM Kurikulum Merdeka Terpadu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="data_default.js"></script>

    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --danger-gradient: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
            --warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --sidebar-bg: linear-gradient(180deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            --card-shadow: 0 10px 40px rgba(0,0,0,0.1);
            --sidebar-width: 260px;
            --sidebar-collapsed: 0px;
        }

        * { box-sizing: border-box; }
        
        body { 
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8ec 100%);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* ========== SIDEBAR ========== */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: var(--sidebar-width);
            height: 100vh;
            background: var(--sidebar-bg);
            color: white;
            z-index: 1050;
            display: flex;
            flex-direction: column;
            transition: transform 0.3s ease;
        }

        .sidebar-header {
            background: rgba(255,255,255,0.1);
            padding: 20px 15px;
            text-align: center;
            flex-shrink: 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-header img {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 3px solid rgba(255,255,255,0.3);
            background: white;
        }

        .sidebar-header h6 {
            margin: 10px 0 5px;
            font-weight: 700;
            font-size: 0.95rem;
        }

        .sidebar-header small {
            font-size: 0.75rem;
            opacity: 0.7;
        }

        /* Scrollable Navigation */
        .sidebar-nav {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 10px 0;
        }

        .sidebar-nav::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-nav::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.05);
        }

        .sidebar-nav::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.2);
            border-radius: 3px;
        }

        .sidebar-nav::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.3);
        }

        .nav-section {
            padding: 8px 15px 5px;
            font-size: 0.65rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: rgba(255,255,255,0.4);
            font-weight: 600;
        }

        .sidebar .nav-link {
            color: rgba(255,255,255,0.75);
            padding: 12px 15px;
            margin: 2px 10px;
            border-radius: 8px;
            font-weight: 500;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s ease;
            text-decoration: none;
            cursor: pointer;
        }

        .sidebar .nav-link i {
            font-size: 1.1rem;
            width: 22px;
            text-align: center;
            flex-shrink: 0;
        }

        .sidebar .nav-link:hover {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        .sidebar .nav-link.active {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .badge-nav {
            font-size: 0.6rem;
            padding: 3px 8px;
            border-radius: 20px;
            margin-left: auto;
            font-weight: 700;
            flex-shrink: 0;
        }

        .badge-free {
            background: var(--secondary-gradient);
            color: white;
        }

        .badge-pro {
            background: var(--warning-gradient);
            color: white;
        }

        .nav-divider {
            height: 1px;
            background: rgba(255,255,255,0.1);
            margin: 10px 15px;
        }

        /* Sidebar Footer */
        .sidebar-footer {
            padding: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
            flex-shrink: 0;
        }

        /* Mobile Toggle */
        .sidebar-toggle {
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1100;
            width: 45px;
            height: 45px;
            border-radius: 10px;
            background: var(--primary-gradient);
            border: none;
            color: white;
            font-size: 1.3rem;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            display: none;
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1040;
            display: none;
        }

        /* ========== CONTENT AREA ========== */
        .content-area {
            margin-left: var(--sidebar-width);
            padding: 25px;
            min-height: 100vh;
            transition: margin-left 0.3s ease;
        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 991px) {
            .sidebar {
                transform: translateX(-100%);
            }

            .sidebar.show {
                transform: translateX(0);
            }

            .sidebar-overlay.show {
                display: block;
            }

            .sidebar-toggle {
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .content-area {
                margin-left: 0;
                padding: 70px 15px 20px;
            }
        }

        @media (max-width: 576px) {
            .sidebar {
                width: 280px;
            }

            .content-area {
                padding: 70px 10px 15px;
            }

            .stats-card {
                padding: 15px !important;
            }

            .stats-number {
                font-size: 1.5rem !important;
            }

            .modern-card .card-body {
                padding: 15px !important;
            }
        }

        /* ========== CARDS ========== */
        .modern-card {
            background: white;
            border-radius: 16px;
            box-shadow: var(--card-shadow);
            border: none;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .modern-card:hover {
            box-shadow: 0 15px 50px rgba(0,0,0,0.12);
        }

        .card-header-gradient {
            background: var(--primary-gradient);
            color: white;
            padding: 18px 20px;
            font-weight: 600;
            font-size: 1rem;
        }

        .card-header-success { background: var(--secondary-gradient); }
        .card-header-danger { background: var(--danger-gradient); }
        .card-header-warning { background: var(--warning-gradient); }

        /* Stats Cards */
        .stats-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            box-shadow: var(--card-shadow);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stats-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
        }

        .stats-card.primary::before { background: var(--primary-gradient); }
        .stats-card.success::before { background: var(--secondary-gradient); }
        .stats-card.warning::before { background: var(--warning-gradient); }
        .stats-card.danger::before { background: var(--danger-gradient); }

        .stats-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 12px;
            font-size: 1.4rem;
            color: white;
        }

        .stats-icon.primary { background: var(--primary-gradient); }
        .stats-icon.success { background: var(--secondary-gradient); }
        .stats-icon.warning { background: var(--warning-gradient); }
        .stats-icon.danger { background: var(--danger-gradient); }

        .stats-number {
            font-size: 1.8rem;
            font-weight: 800;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stats-label {
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 5px;
        }

        /* ========== BUTTONS ========== */
        .btn-gradient-primary {
            background: var(--primary-gradient);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.35);
            transition: all 0.3s ease;
        }

        .btn-gradient-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.45);
            color: white;
        }

        .btn-gradient-success {
            background: var(--secondary-gradient);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(17, 153, 142, 0.35);
        }

        .btn-gradient-success:hover {
            transform: translateY(-2px);
            color: white;
        }

        .btn-gradient-danger {
            background: var(--danger-gradient);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            font-weight: 600;
            box-shadow: 0 4px 15px rgba(235, 51, 73, 0.35);
        }

        .btn-gradient-danger:hover {
            transform: translateY(-2px);
            color: white;
        }

        .btn-google {
            background: white;
            border: 2px solid #e0e0e0;
            color: #333;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
        }

        .btn-google:hover {
            background: #f8f9fa;
            border-color: #ccc;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .btn-google img {
            width: 20px;
            height: 20px;
        }

        .btn-whatsapp {
            background: linear-gradient(135deg, #25D366 0%, #128C7E 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: 700;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 6px 20px rgba(37, 211, 102, 0.4);
        }

        .btn-whatsapp:hover {
            transform: scale(1.03);
            color: white;
        }

        /* ========== FORMS ========== */
        .form-control, .form-select {
            border-radius: 10px;
            border: 2px solid #e9ecef;
            padding: 10px 15px;
            font-size: 0.9rem;
            transition: all 0.2s ease;
        }

        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.15);
        }

        /* ========== TABLES ========== */
        .modern-table {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }

        .modern-table thead {
            background: var(--primary-gradient);
            color: white;
        }

        .modern-table th {
            padding: 14px 12px;
            font-weight: 600;
            font-size: 0.85rem;
            border: none;
        }

        .modern-table td {
            padding: 12px;
            vertical-align: middle;
            border-bottom: 1px solid #f0f0f0;
            font-size: 0.9rem;
        }

        .modern-table tbody tr:hover {
            background: rgba(102, 126, 234, 0.03);
        }

        /* ========== DOCUMENT STYLES ========== */
        .document-page {
            background: white;
            padding: 40px;
            box-shadow: var(--card-shadow);
            border-radius: 10px;
            margin-bottom: 20px;
            font-family: 'Times New Roman', Times, serif;
            color: black;
        }

        .doc-header {
            text-align: center;
            font-weight: bold;
            font-size: 14pt;
            margin-bottom: 15px;
            text-transform: uppercase;
            line-height: 1.4;
        }

        table.doc-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11pt;
            margin-bottom: 15px;
        }

        table.doc-table th, table.doc-table td {
            border: 1px solid black;
            padding: 8px;
            vertical-align: middle;
        }

        table.doc-table th {
            background-color: #f0f0f0;
            text-align: center;
            font-weight: bold;
        }

        table.identity-table {
            width: 100%;
            margin-bottom: 15px;
            font-size: 11pt;
        }

        table.identity-table td {
            padding: 3px;
            vertical-align: top;
        }

        .signature-area {
            width: 100%;
            margin-top: 40px;
            display: table;
        }

        .signature-box {
            display: table-cell;
            width: 50%;
            text-align: center;
            font-size: 11pt;
        }

        .signature-name {
            text-decoration: underline;
            font-weight: bold;
            margin-top: 70px;
        }

        /* ========== UPGRADE MODAL ========== */
        .price-tag {
            font-size: 2.5rem;
            font-weight: 800;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .feature-list li {
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
            font-size: 0.9rem;
        }

        .feature-list li i {
            color: #38ef7d;
            margin-right: 8px;
        }

        /* ========== ANIMATIONS ========== */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-fadeIn {
            animation: fadeIn 0.4s ease forwards;
        }

        /* ========== PRINT STYLES ========== */
        @media print {
            @page { margin: 15mm; }
            body { background: white !important; }
            .no-print, .sidebar, .sidebar-toggle, .sidebar-overlay { display: none !important; }
            .content-area { margin: 0 !important; padding: 0 !important; }
            .document-page { box-shadow: none !important; margin: 0 !important; padding: 0 !important; border-radius: 0 !important; }
            .hide-on-print { display: none !important; }
        }
    </style>
</head>
<body>

    <!-- Mobile Sidebar Toggle -->
    <button class="sidebar-toggle no-print" onclick="toggleSidebar()">
        <i class="bi bi-list"></i>
    </button>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay no-print" onclick="toggleSidebar()"></div>

    <!-- Upgrade Modal -->
    <div class="modal fade" id="upgradeModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content" style="border-radius: 20px; overflow: hidden;">
                <div class="modal-header text-center flex-column py-4" style="background: var(--warning-gradient); border: none;">
                    <i class="bi bi-gem text-white" style="font-size: 3rem;"></i>
                    <h4 class="mt-2 mb-0 text-white fw-bold">Upgrade ke Premium</h4>
                    <p class="mb-0 text-white opacity-75">Akses semua fitur tanpa batas!</p>
                </div>
                <div class="modal-body p-4">
                    <div class="row">
                        <div class="col-md-6 mb-3 mb-md-0">
                            <h6 class="fw-bold mb-3">✨ Fitur Premium:</h6>
                            <ul class="list-unstyled feature-list">
                                <li><i class="bi bi-check-circle-fill"></i> Modul Ajar Generator</li>
                                <li><i class="bi bi-check-circle-fill"></i> LKPD Generator</li>
                                <li><i class="bi bi-check-circle-fill"></i> Jurnal & Absensi</li>
                                <li><i class="bi bi-check-circle-fill"></i> Rekap Penilaian</li>
                                <li><i class="bi bi-check-circle-fill"></i> Asisten AI Prompts</li>
                                <li><i class="bi bi-check-circle-fill"></i> Update Seumur Hidup</li>
                            </ul>
                        </div>
                        <div class="col-md-6 text-center">
                            <p class="text-muted mb-1 small">Harga Spesial</p>
                            <div class="price-tag" id="displayPrice">Rp 99.000</div>
                            <p class="text-muted small">Sekali bayar, akses selamanya!</p>
                            
                            <div class="card p-3 bg-light mt-3 text-start">
                                <p class="small mb-1 fw-bold">Transfer ke:</p>
                                <p class="mb-1 small" id="displayBank">BCA - 1234567890</p>
                                <p class="mb-0 small fw-bold" id="displayAccountName">a.n. Admin</p>
                            </div>

                            <a href="#" id="waUpgradeBtn" class="btn btn-whatsapp mt-3 w-100" target="_blank">
                                <i class="bi bi-whatsapp"></i> Hubungi WhatsApp
                            </a>
                        </div>
                    </div>
                </div>
                <div class="modal-footer justify-content-center border-0 pb-4">
                    <button type="button" class="btn btn-light px-4" data-bs-dismiss="modal">Nanti Saja</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp">
        <!-- Sidebar -->
        <div class="sidebar no-print" id="sidebar">
            <div class="sidebar-header">
                <img src="data:image/svg+xml;charset=UTF-8,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%23667eea'/%3E%3Ctext x='50' y='62' text-anchor='middle' fill='white' font-size='35' font-weight='bold'%3EKM%3C/text%3E%3C/svg%3E" alt="Logo">
                <h6>SIM Kurikulum</h6>
                <small id="userRole">Versi Gratis</small>
            </div>
            
            <div class="sidebar-nav">
                <div class="nav-section">MENU UTAMA</div>
                <a class="nav-link active" onclick="showTab('tabDashboard')">
                    <i class="bi bi-speedometer2"></i> Dashboard
                </a>
                <a class="nav-link" onclick="showTab('tabProfil')">
                    <i class="bi bi-building"></i> Profil Instansi
                    <span class="badge-nav badge-free">FREE</span>
                </a>
                <a class="nav-link" onclick="showTab('tabCPTP')">
                    <i class="bi bi-bullseye"></i> Setup CP & TP
                    <span class="badge-nav badge-free">FREE</span>
                </a>

                <div class="nav-divider"></div>
                <div class="nav-section">DATA & JADWAL</div>
                
                <a class="nav-link" onclick="showTab('tabSiswa')">
                    <i class="bi bi-people"></i> Data Siswa
                    <span class="badge-nav badge-free">FREE</span>
                </a>
                <a class="nav-link" onclick="showTab('tabJadwal')">
                    <i class="bi bi-calendar3"></i> Jadwal Mengajar
                    <span class="badge-nav badge-free">FREE</span>
                </a>

                <div class="nav-divider"></div>
                <div class="nav-section">PERANGKAT AJAR</div>
                
                <a class="nav-link" onclick="showTab('tabTahunan')">
                    <i class="bi bi-folder2-open"></i> ATP & Prota
                    <span class="badge-nav badge-free">FREE</span>
                </a>
                <a class="nav-link" onclick="checkPremium('tabPerangkat')">
                    <i class="bi bi-book"></i> Modul & LKPD
                    <span class="badge-nav badge-pro">PRO</span>
                </a>
                <a class="nav-link" onclick="checkPremium('tabPelaksanaan')">
                    <i class="bi bi-journal-check"></i> Absen & Jurnal
                    <span class="badge-nav badge-pro">PRO</span>
                </a>
                <a class="nav-link" onclick="checkPremium('tabPenilaian')">
                    <i class="bi bi-graph-up"></i> Rekap Penilaian
                    <span class="badge-nav badge-pro">PRO</span>
                </a>

                <div class="nav-divider"></div>
                <div class="nav-section">BANTUAN</div>
                
                <a class="nav-link" onclick="showTab('tabPanduan')">
                    <i class="bi bi-question-circle"></i> Buku Panduan
                </a>
                <a class="nav-link" onclick="checkPremium('tabAI')">
                    <i class="bi bi-robot"></i> Asisten AI
                    <span class="badge-nav badge-pro">PRO</span>
                </a>

                <!-- Admin Menu - Hidden by default -->
                <div id="adminMenuSection" class="d-none">
                    <div class="nav-divider"></div>
                    <div class="nav-section">ADMINISTRATOR</div>
                    <a class="nav-link" onclick="showTab('tabAdmin')">
                        <i class="bi bi-shield-lock"></i> Admin Panel
                    </a>
                </div>
            </div>

            <div class="sidebar-footer">
                <div id="loginSection">
                    <button class="btn btn-outline-light btn-sm w-100" onclick="handleGoogleLogin()">
                        <i class="bi bi-box-arrow-in-right me-2"></i>Login Admin
                    </button>
                </div>
                <div id="logoutSection" class="d-none">
                    <div class="d-flex align-items-center gap-2 mb-2">
                        <img id="adminAvatar" src="" class="rounded-circle" width="32" height="32" style="display:none;">
                        <small id="adminName" class="text-truncate"></small>
                    </div>
                    <button class="btn btn-outline-danger btn-sm w-100" onclick="handleLogout()">
                        <i class="bi bi-box-arrow-right me-2"></i>Logout
                    </button>
                </div>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area" id="mainContentArea">
            
            <!-- Dashboard -->
            <div id="tabDashboard" class="tab-content animate-fadeIn">
                <div class="d-flex flex-wrap justify-content-between align-items-center mb-4 gap-2">
                    <div>
                        <h4 class="fw-bold mb-1">Dashboard</h4>
                        <p class="text-muted mb-0 small">Selamat datang di SIM Kurikulum Merdeka</p>
                    </div>
                    <button class="btn btn-gradient-primary btn-sm" onclick="showUpgradeModal()">
                        <i class="bi bi-gem me-1"></i>Upgrade Premium
                    </button>
                </div>

                <!-- Stats -->
                <div class="row g-3 mb-4">
                    <div class="col-6 col-md-3">
                        <div class="stats-card primary">
                            <div class="stats-icon primary"><i class="bi bi-people"></i></div>
                            <div class="stats-number" id="statSiswa">0</div>
                            <div class="stats-label">Total Siswa</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stats-card success">
                            <div class="stats-icon success"><i class="bi bi-calendar-check"></i></div>
                            <div class="stats-number" id="statJadwal">0</div>
                            <div class="stats-label">Jadwal</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stats-card warning">
                            <div class="stats-icon warning"><i class="bi bi-book"></i></div>
                            <div class="stats-number" id="statTP">0</div>
                            <div class="stats-label">Tujuan Pembelajaran</div>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stats-card danger">
                            <div class="stats-icon danger"><i class="bi bi-mortarboard"></i></div>
                            <div class="stats-number" id="statRombel">0</div>
                            <div class="stats-label">Rombel</div>
                        </div>
                    </div>
                </div>

                <!-- Info Cards -->
                <div class="row g-3">
                    <div class="col-lg-8">
                        <div class="modern-card h-100">
                            <div class="card-header-gradient">
                                <i class="bi bi-info-circle me-2"></i>Tentang Aplikasi
                            </div>
                            <div class="card-body p-4">
                                <h6 class="fw-bold">Sistem Manajemen Kurikulum Merdeka Universal</h6>
                                <p class="text-muted small mb-3">Aplikasi terintegrasi untuk mengelola perangkat pembelajaran sesuai Kurikulum Merdeka.</p>
                                
                                <div class="row g-2">
                                    <div class="col-md-6">
                                        <div class="d-flex align-items-center p-3 bg-light rounded-3">
                                            <i class="bi bi-check-circle-fill text-success me-3"></i>
                                            <div>
                                                <strong class="small">Gratis Selamanya</strong>
                                                <div class="small text-muted">Jadwal, ATP, Prota, Data Siswa</div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="d-flex align-items-center p-3 bg-light rounded-3">
                                            <i class="bi bi-gem text-primary me-3"></i>
                                            <div>
                                                <strong class="small">Premium</strong>
                                                <div class="small text-muted">Modul, Penilaian, AI, dll</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="modern-card h-100">
                            <div class="card-header-gradient card-header-success">
                                <i class="bi bi-lightning me-2"></i>Quick Actions
                            </div>
                            <div class="card-body p-3">
                                <div class="d-grid gap-2">
                                    <button class="btn btn-outline-primary btn-sm" onclick="showTab('tabProfil')">
                                        <i class="bi bi-pencil me-2"></i>Edit Profil
                                    </button>
                                    <button class="btn btn-outline-success btn-sm" onclick="showTab('tabSiswa')">
                                        <i class="bi bi-upload me-2"></i>Import Siswa
                                    </button>
                                    <button class="btn btn-outline-info btn-sm" onclick="showTab('tabCPTP')">
                                        <i class="bi bi-bullseye me-2"></i>Setup TP
                                    </button>
                                    <button class="btn btn-outline-danger btn-sm" onclick="showTab('tabTahunan')">
                                        <i class="bi bi-printer me-2"></i>Cetak ATP
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Panel -->
            <div id="tabAdmin" class="tab-content d-none animate-fadeIn">
                <div class="d-flex flex-wrap justify-content-between align-items-center mb-4 gap-2">
                    <div>
                        <h4 class="fw-bold mb-1"><i class="bi bi-shield-lock me-2"></i>Admin Panel</h4>
                        <p class="text-muted mb-0 small">Kelola pengaturan aplikasi</p>
                    </div>
                </div>

                <div class="row g-3">
                    <div class="col-lg-6">
                        <div class="modern-card">
                            <div class="card-header-gradient">
                                <i class="bi bi-gear me-2"></i>Pengaturan Harga & Kontak
                            </div>
                            <div class="card-body p-4">
                                <div class="mb-3">
                                    <label class="form-label fw-bold small">Harga Premium (Rp)</label>
                                    <input type="number" id="adminPrice" class="form-control" placeholder="99000">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-bold small">Nomor WhatsApp</label>
                                    <input type="text" id="adminWA" class="form-control" placeholder="6281234567890">
                                    <small class="text-muted">Format: 62xxx tanpa + atau 0</small>
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-bold small">Nama Bank</label>
                                    <input type="text" id="adminBank" class="form-control" placeholder="BCA">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-bold small">Nomor Rekening</label>
                                    <input type="text" id="adminRekening" class="form-control" placeholder="1234567890">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label fw-bold small">Atas Nama</label>
                                    <input type="text" id="adminNamaRek" class="form-control" placeholder="Nama Pemilik">
                                </div>
                                <button class="btn btn-gradient-primary w-100" onclick="saveAdminSettings()">
                                    <i class="bi bi-save me-2"></i>Simpan Pengaturan
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-6">
                        <div class="modern-card mb-3">
                            <div class="card-header-gradient card-header-success">
                                <i class="bi bi-person-check me-2"></i>Aktivasi User Premium
                            </div>
                            <div class="card-body p-4">
                                <div class="mb-3">
                                    <label class="form-label fw-bold small">Kode Aktivasi User</label>
                                    <input type="text" id="userActivationCode" class="form-control" placeholder="SIM-XXXXXX-XXXXX">
                                </div>
                                <button class="btn btn-gradient-success w-100" onclick="activateUserPremium()">
                                    <i class="bi bi-check2-circle me-2"></i>Aktifkan Premium
                                </button>
                            </div>
                        </div>

                        <div class="modern-card">
                            <div class="card-header-gradient card-header-warning">
                                <i class="bi bi-list-check me-2"></i>Kode yang Sudah Diaktivasi
                            </div>
                            <div class="card-body p-3">
                                <div id="activatedCodesList" class="small" style="max-height: 200px; overflow-y: auto;">
                                    <p class="text-muted mb-0">Belum ada kode yang diaktivasi.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Panduan -->
            <div id="tabPanduan" class="tab-content d-none no-print animate-fadeIn">
                <h4 class="fw-bold mb-4"><i class="bi bi-book me-2"></i>Buku Panduan</h4>
                
                <div class="modern-card">
                    <div class="card-body p-4">
                        <div class="accordion" id="accordionPanduan">
                            <div class="accordion-item border-0 mb-2">
                                <h2 class="accordion-header">
                                    <button class="accordion-button bg-light rounded fw-bold small" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1">
                                        <i class="bi bi-1-circle-fill text-primary me-2"></i>
                                        Cara Memasukkan CP dan TP
                                    </button>
                                </h2>
                                <div id="collapse1" class="accordion-collapse collapse show" data-bs-parent="#accordionPanduan">
                                    <div class="accordion-body small">
                                        <ol>
                                            <li>Buka menu <b>Setup CP & TP</b></li>
                                            <li>Masukkan narasi Capaian Pembelajaran (CP)</li>
                                            <li>Klik <b>Tambah Bab</b> untuk menambah TP</li>
                                            <li>Isi Nomor Bab, Judul, dan Alokasi JP</li>
                                            <li>Klik <b>Simpan</b></li>
                                        </ol>
                                        <p class="text-success mb-0"><i>Guru PAI SD: Gunakan tombol Load Data Default</i></p>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item border-0 mb-2">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed bg-light rounded fw-bold small" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2">
                                        <i class="bi bi-2-circle-fill text-success me-2"></i>
                                        Cara Input Data Siswa via CSV
                                    </button>
                                </h2>
                                <div id="collapse2" class="accordion-collapse collapse" data-bs-parent="#accordionPanduan">
                                    <div class="accordion-body small">
                                        <ol>
                                            <li>Buat file Excel dengan kolom: <code>nisn, nama, jk, kelas, rombel</code></li>
                                            <li>Contoh: <code>001234, Budi Santoso, L, 3, 3A</code></li>
                                            <li>Save As → format <b>CSV</b></li>
                                            <li>Upload di menu <b>Data Siswa</b></li>
                                        </ol>
                                    </div>
                                </div>
                            </div>

                            <div class="accordion-item border-0">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed bg-light rounded fw-bold small" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3">
                                        <i class="bi bi-3-circle-fill text-warning me-2"></i>
                                        Tips Cetak PDF yang Benar
                                    </button>
                                </h2>
                                <div id="collapse3" class="accordion-collapse collapse" data-bs-parent="#accordionPanduan">
                                    <div class="accordion-body small">
                                        <ol>
                                            <li>Klik tombol <b>Cetak</b> di aplikasi</li>
                                            <li>Centang <b>"Background graphics"</b></li>
                                            <li>Margins: <b>Default</b> atau <b>None</b></li>
                                            <li>Pilih <b>Save as PDF</b></li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Tab -->
            <div id="tabAI" class="tab-content d-none no-print animate-fadeIn">
                <h4 class="fw-bold mb-4"><i class="bi bi-robot me-2"></i>Asisten AI (Prompt)</h4>
                <p class="text-muted small mb-4">Salin prompt ke ChatGPT, Gemini, atau Claude</p>
                
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="modern-card h-100">
                            <div class="card-header-gradient">
                                <i class="bi bi-file-spreadsheet me-2"></i>Data CSV Siswa
                            </div>
                            <div class="card-body p-3">
                                <textarea id="prompt1" class="form-control bg-light mb-2 small" rows="3" readonly>Buatkan data siswa 20 orang format CSV. Header: nisn,nama,jk,kelas,rombel. Untuk kelas 4 rombel 4A.</textarea>
                                <button class="btn btn-gradient-primary btn-sm w-100" onclick="copyToClipboard('prompt1')">
                                    <i class="bi bi-clipboard me-1"></i>Salin
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="modern-card h-100">
                            <div class="card-header-gradient card-header-success">
                                <i class="bi bi-list-check me-2"></i>Menyusun TP
                            </div>
                            <div class="card-body p-3">
                                <textarea id="prompt2" class="form-control bg-light mb-2 small" rows="3" readonly>Saya Guru [MAPEL] Fase [FASE]. Buatkan TP per Bab untuk 1 Semester format tabel: Bab, Judul TP, Alokasi JP. Total 72 JP.</textarea>
                                <button class="btn btn-gradient-success btn-sm w-100" onclick="copyToClipboard('prompt2')">
                                    <i class="bi bi-clipboard me-1"></i>Salin
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="modern-card h-100">
                            <div class="card-header-gradient card-header-warning">
                                <i class="bi bi-book me-2"></i>Skenario Modul
                            </div>
                            <div class="card-body p-3">
                                <textarea id="prompt3" class="form-control bg-light mb-2 small" rows="3" readonly>Buatkan skenario Kegiatan Inti 110 menit untuk [MAPEL] kelas [KELAS] topik [MATERI]. Integrasikan Kemandirian, Penalaran Kritis, Kolaborasi.</textarea>
                                <button class="btn btn-gradient-danger btn-sm w-100" onclick="copyToClipboard('prompt3')">
                                    <i class="bi bi-clipboard me-1"></i>Salin
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="modern-card h-100">
                            <div class="card-header-gradient card-header-danger">
                                <i class="bi bi-patch-question me-2"></i>Soal HOTS
                            </div>
                            <div class="card-body p-3">
                                <textarea id="prompt4" class="form-control bg-light mb-2 small" rows="3" readonly>Buatkan 5 soal PG dan 2 uraian HOTS beserta kunci jawaban untuk [MAPEL] Kelas [KELAS] topik [MATERI].</textarea>
                                <button class="btn btn-gradient-primary btn-sm w-100" onclick="copyToClipboard('prompt4')">
                                    <i class="bi bi-clipboard me-1"></i>Salin
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profil -->
            <div id="tabProfil" class="tab-content d-none no-print animate-fadeIn">
                <h4 class="fw-bold mb-4"><i class="bi bi-building me-2"></i>Profil & Instansi</h4>
                
                <div class="modern-card">
                    <div class="card-header-gradient card-header-warning">
                        <i class="bi bi-pencil-square me-2"></i>Edit Data Profil
                    </div>
                    <div class="card-body p-4">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label class="form-label fw-bold small">Mata Pelajaran <span class="text-danger">*</span></label>
                                <input type="text" id="profMapel" class="form-control" value="Pendidikan Agama Islam">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold small">NPSN Sekolah</label>
                                <input type="number" id="profNpsn" class="form-control" placeholder="12345678">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold small">Nama Sekolah</label>
                                <input type="text" id="profSekolah" class="form-control" placeholder="SDN 1 ...">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold small">Kepala Sekolah</label>
                                <input type="text" id="profKepsek" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-bold small">NIP Kepsek</label>
                                <input type="text" id="profNipKepsek" class="form-control">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold small">Nama Guru Pengampu</label>
                                <input type="text" id="profGuru" class="form-control">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold small">NIP Guru</label>
                                <input type="text" id="profNipGuru" class="form-control">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-bold small">Tahun Ajaran</label>
                                <input type="text" id="profTahun" class="form-control" value="2025/2026">
                            </div>
                            <div class="col-12">
                                <label class="form-label fw-bold small">Tempat, Tgl Pengesahan</label>
                                <input type="text" id="profTanggal" class="form-control" placeholder="Jakarta, 15 Juli 2025">
                            </div>
                            <div class="col-12 mt-3">
                                <button class="btn btn-gradient-primary" onclick="simpanProfil()">
                                    <i class="bi bi-save me-2"></i>Simpan Profil
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CP & TP -->
            <div id="tabCPTP" class="tab-content d-none no-print animate-fadeIn">
                <h4 class="fw-bold mb-4"><i class="bi bi-bullseye me-2"></i>Setup CP & TP</h4>
                
                <div class="modern-card mb-3">
                    <div class="card-header-gradient">
                        <i class="bi bi-database me-2"></i>Load Data Default PAI SD
                    </div>
                    <div class="card-body p-3">
                        <div class="row g-2">
                            <div class="col">
                                <select id="loadDefaultKls" class="form-select">
                                    <option value="1">Kelas 1 (Fase A)</option>
                                    <option value="2">Kelas 2 (Fase A)</option>
                                    <option value="3">Kelas 3 (Fase B)</option>
                                    <option value="4">Kelas 4 (Fase B)</option>
                                    <option value="5">Kelas 5 (Fase C)</option>
                                    <option value="6">Kelas 6 (Fase C)</option>
                                </select>
                            </div>
                            <div class="col-auto">
                                <button class="btn btn-gradient-primary" onclick="loadDefaultPAI()">
                                    <i class="bi bi-download me-1"></i>Load
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modern-card">
                    <div class="card-header-gradient card-header-success">
                        <i class="bi bi-pencil me-2"></i>Input Manual
                    </div>
                    <div class="card-body p-4">
                        <div class="mb-3">
                            <label class="form-label fw-bold small">Capaian Pembelajaran (CP):</label>
                            <textarea id="inputCP" class="form-control" rows="3" placeholder="Masukkan narasi CP..."></textarea>
                        </div>
                        
                        <label class="form-label fw-bold small mb-2">Daftar Tujuan Pembelajaran (TP):</label>
                        <div class="table-responsive">
                            <table class="table modern-table">
                                <thead><tr><th width="15%">Bab</th><th>Tujuan Pembelajaran</th><th width="15%">JP</th></tr></thead>
                                <tbody id="bodyInputTP"></tbody>
                            </table>
                        </div>
                        
                        <div class="d-flex flex-wrap gap-2 mt-3">
                            <button class="btn btn-outline-primary btn-sm" onclick="tambahBarisTP()">
                                <i class="bi bi-plus-circle me-1"></i>Tambah Bab
                            </button>
                            <button class="btn btn-gradient-success" onclick="simpanCPTP()">
                                <i class="bi bi-save me-1"></i>Simpan CP & TP
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Siswa -->
            <div id="tabSiswa" class="tab-content d-none no-print animate-fadeIn">
                <h4 class="fw-bold mb-4"><i class="bi bi-people me-2"></i>Data Siswa</h4>
                
                <div class="modern-card mb-3">
                    <div class="card-header-gradient">
                        <i class="bi bi-upload me-2"></i>Import dari CSV
                    </div>
                    <div class="card-body p-3">
                        <div class="alert alert-warning py-2 small mb-2">
                            <i class="bi bi-info-circle me-1"></i>Header: <code>nisn, nama, jk, kelas, rombel</code>
                        </div>
                        <input type="file" id="fileCsvSiswa" class="form-control mb-2" accept=".csv">
                        <button class="btn btn-gradient-primary w-100" onclick="importSiswaLokal()">
                            <i class="bi bi-cloud-upload me-1"></i>Upload CSV
                        </button>
                    </div>
                </div>

                <div class="modern-card">
                    <div class="card-body p-3">
                        <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-3">
                            <select id="filterKelasSiswa" class="form-select form-select-sm w-auto" onchange="renderTabelSiswa()"></select>
                            <button class="btn btn-outline-danger btn-sm" onclick="clearDataSiswa()">
                                <i class="bi bi-trash me-1"></i>Hapus Semua
                            </button>
                        </div>
                        <div class="table-responsive">
                            <table class="table modern-table">
                                <thead><tr><th>NISN</th><th>Nama</th><th>JK</th><th>Kelas</th><th>Rombel</th></tr></thead>
                                <tbody id="tabelSiswaBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Jadwal -->
            <div id="tabJadwal" class="tab-content d-none no-print animate-fadeIn">
                <h4 class="fw-bold mb-4"><i class="bi bi-calendar3 me-2"></i>Jadwal Mengajar</h4>
                
                <div class="modern-card mb-3">
                    <div class="card-header-gradient card-header-success">
                        <i class="bi bi-plus-circle me-2"></i>Tambah Jadwal
                    </div>
                    <div class="card-body p-3">
                        <div class="row g-2">
                            <div class="col-6 col-md-2">
                                <label class="form-label small fw-bold">Hari</label>
                                <select id="jadwalHari" class="form-select form-select-sm">
                                    <option>Senin</option><option>Selasa</option><option>Rabu</option><option>Kamis</option><option>Jumat</option>
                                </select>
                            </div>
                            <div class="col-6 col-md-2">
                                <label class="form-label small fw-bold">Jam Ke-</label>
                                <input type="number" id="jadwalJam" class="form-control form-control-sm" placeholder="1">
                            </div>
                            <div class="col-6 col-md-3">
                                <label class="form-label small fw-bold">Fase</label>
                                <select id="jadwalFase" class="form-select form-select-sm">
                                    <option value="A">Fase A</option><option value="B">Fase B</option><option value="C">Fase C</option><option value="D">Fase D</option>
                                </select>
                            </div>
                            <div class="col-6 col-md-3">
                                <label class="form-label small fw-bold">Rombel</label>
                                <input type="text" id="jadwalRombel" class="form-control form-control-sm" placeholder="3A">
                            </div>
                            <div class="col-12 col-md-2 d-flex align-items-end">
                                <button class="btn btn-gradient-success btn-sm w-100" onclick="tambahJadwalLokal()">
                                    <i class="bi bi-plus me-1"></i>Tambah
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="modern-card">
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table modern-table mb-0">
                                <thead><tr><th>Hari</th><th>Jam</th><th>Fase</th><th>Rombel</th><th width="80">Aksi</th></tr></thead>
                                <tbody id="tabelJadwalBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tahunan (ATP, Prota, Promes) -->
            <div id="tabTahunan" class="tab-content d-none animate-fadeIn">
                <div class="no-print">
                    <h4 class="fw-bold mb-4"><i class="bi bi-folder2-open me-2"></i>Program Tahunan & ATP</h4>
                    
                    <div class="modern-card mb-3">
                        <div class="card-body p-3">
                            <div class="row g-2 align-items-end">
                                <div class="col-12 col-md-4">
                                    <label class="form-label small fw-bold">Pilih Fase & Rombel</label>
                                    <select id="tFaseRombel" class="form-select form-select-sm"></select>
                                </div>
                                <div class="col-6 col-md-2">
                                    <button class="btn btn-gradient-primary btn-sm w-100" onclick="generateTahunan()">
                                        <i class="bi bi-arrow-repeat me-1"></i>Load
                                    </button>
                                </div>
                                <div class="col-6 col-md-6 text-end">
                                    <div class="btn-group btn-group-sm">
                                        <button class="btn btn-gradient-danger" onclick="triggerPrint('docATP', 'ATP')">ATP</button>
                                        <button class="btn btn-gradient-danger" onclick="triggerPrint('docProta', 'Prota')">Prota</button>
                                        <button class="btn btn-gradient-danger" onclick="triggerPrint('docPromes', 'Promes')">Promes</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Documents -->
                <div id="docATP" class="document-page print-view d-none">
                    <div class="doc-header">ALUR TUJUAN PEMBELAJARAN (ATP)</div>
                    <table class="identity-table mb-3">
                        <tr><td width="15%">Sekolah</td><td width="3%">:</td><td class="vSekolah"></td><td width="15%">Mata Pelajaran</td><td width="3%">:</td><td class="vMapel"></td></tr>
                        <tr><td>Fase / Rombel</td><td>:</td><td class="vFaseRombel"></td><td>Tahun Ajaran</td><td>:</td><td class="vTahun"></td></tr>
                    </table>
                    <div class="mb-2"><b>Capaian Pembelajaran:</b> <span id="vCPATP"></span></div>
                    <table class="doc-table"><tr><th width="10%">Bab</th><th>Alur Tujuan Pembelajaran</th><th width="15%">Alokasi JP</th></tr><tbody id="tblAtpBody"></tbody></table>
                    <div class="signature-area">
                        <div class="signature-box">Mengetahui,<br>Kepala Sekolah<div class="signature-name vKepsek"></div>NIP. <span class="vNipKepsek"></span></div>
                        <div class="signature-box"><span class="vTanggal"></span><br>Guru <span class="vMapel"></span><div class="signature-name vGuru"></div>NIP. <span class="vNipGuru"></span></div>
                    </div>
                </div>

                <div id="docProta" class="document-page print-view d-none">
                    <div class="doc-header">PROGRAM TAHUNAN (PROTA)</div>
                    <table class="identity-table mb-3">
                        <tr><td width="15%">Mata Pelajaran</td><td>:</td><td class="vMapel"></td><td width="15%">Fase/Rombel</td><td>:</td><td class="vFaseRombel"></td></tr>
                    </table>
                    <table class="doc-table"><tr><th>Semester</th><th>Bab / Tujuan Pembelajaran</th><th>Alokasi JP</th><th>Keterangan</th></tr><tbody id="tblProtaBody"></tbody></table>
                    <div class="signature-area">
                        <div class="signature-box">Kepala Sekolah<div class="signature-name vKepsek"></div></div>
                        <div class="signature-box">Guru <span class="vMapel"></span><div class="signature-name vGuru"></div></div>
                    </div>
                </div>

                <div id="docPromes" class="document-page print-view d-none">
                    <div class="doc-header">PROGRAM SEMESTER (PROMES)</div>
                    <table class="identity-table mb-2"><tr><td width="10%">Sekolah</td><td>:</td><td class="vSekolah"></td><td width="10%">Mapel</td><td>:</td><td class="vMapel"></td></tr></table>
                    <table class="doc-table" style="font-size: 9pt;">
                        <tr><th rowspan="2">Tujuan Pembelajaran</th><th rowspan="2">JP</th><th colspan="4">Juli</th><th colspan="4">Agustus</th><th colspan="4">September</th><th colspan="4">Oktober</th></tr>
                        <tr><th>1</th><th>2</th><th>3</th><th>4</th><th>1</th><th>2</th><th>3</th><th>4</th><th>1</th><th>2</th><th>3</th><th>4</th><th>1</th><th>2</th><th>3</th><th>4</th></tr>
                        <tbody id="tblPromesBody"></tbody>
                    </table>
                    <div class="signature-area mt-4">
                        <div class="signature-box">Kepala Sekolah<div class="signature-name vKepsek"></div></div>
                        <div class="signature-box">Guru <span class="vMapel"></span><div class="signature-name vGuru"></div></div>
                    </div>
                </div>
            </div>

            <!-- Perangkat (Premium) -->
            <div id="tabPerangkat" class="tab-content d-none animate-fadeIn">
                <div class="no-print">
                    <h4 class="fw-bold mb-4"><i class="bi bi-book me-2"></i>Modul Ajar</h4>
                    
                    <div class="modern-card mb-3">
                        <div class="card-body p-3">
                            <div class="row g-2 align-items-end">
                                <div class="col-12 col-md-4">
                                    <label class="form-label small fw-bold">Jadwal</label>
                                    <select id="pSelectJadwal" class="form-select form-select-sm"></select>
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label small fw-bold">Materi (TP)</label>
                                    <select id="pSelectTP" class="form-select form-select-sm"></select>
                                </div>
                                <div class="col-6 col-md-2">
                                    <button class="btn btn-gradient-success btn-sm w-100" onclick="generateModul()">Buat</button>
                                </div>
                                <div class="col-6 col-md-2">
                                    <button class="btn btn-gradient-danger btn-sm w-100" onclick="triggerPrint('docModul', 'Modul')">Cetak</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="docModul" class="document-page print-view d-none">
                    <div class="doc-header">MODUL AJAR KURIKULUM MERDEKA</div>
                    <b>A. INFORMASI UMUM</b>
                    <table class="identity-table mt-2 mb-3">
                        <tr><td width="20%">Penyusun</td><td>:</td><td class="vGuru fw-bold"></td><td width="15%">Instansi</td><td>:</td><td class="vSekolah"></td></tr>
                        <tr><td>Mata Pelajaran</td><td>:</td><td class="vMapel"></td><td>Fase / Rombel</td><td>:</td><td class="vFaseRombel"></td></tr>
                    </table>
                    <b>B. CAPAIAN & TUJUAN PEMBELAJARAN</b>
                    <p class="mb-3">Peserta didik mampu memahami: <b><span id="outMateriModul">...</span></b>.</p>
                    <b>C. KEGIATAN PEMBELAJARAN</b>
                    <table class="doc-table mt-2">
                        <tr><th width="20%">Tahap</th><th>Deskripsi</th></tr>
                        <tr><td><b>Pendahuluan</b><br>(15 Menit)</td><td>1. Berdoa.<br>2. Presensi.<br>3. Apersepsi.</td></tr>
                        <tr><td><b>Inti</b><br>(110 Menit)</td><td>1. Penjelasan materi.<br>2. Diskusi kelompok.<br>3. Pengerjaan LKPD.</td></tr>
                        <tr><td><b>Penutup</b><br>(15 Menit)</td><td>1. Kesimpulan.<br>2. Doa penutup.</td></tr>
                    </table>
                    <div class="signature-area">
                        <div class="signature-box">Kepala Sekolah<div class="signature-name vKepsek"></div></div>
                        <div class="signature-box">Guru <span class="vMapel"></span><div class="signature-name vGuru"></div></div>
                    </div>
                </div>
            </div>

            <!-- Pelaksanaan (Premium) -->
            <div id="tabPelaksanaan" class="tab-content d-none animate-fadeIn">
                <div class="no-print">
                    <h4 class="fw-bold mb-4"><i class="bi bi-journal-check me-2"></i>Absensi & Jurnal</h4>
                    
                    <div class="modern-card mb-3">
                        <div class="card-body p-3">
                            <div class="row g-2 align-items-end">
                                <div class="col-12 col-md-4">
                                    <label class="form-label small fw-bold">Jadwal</label>
                                    <select id="selectJadwalAbsen" class="form-select form-select-sm"></select>
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label small fw-bold">Materi</label>
                                    <select id="selectTPAbsen" class="form-select form-select-sm"></select>
                                </div>
                                <div class="col-6 col-md-2">
                                    <button class="btn btn-gradient-primary btn-sm w-100" onclick="loadAbsensi()">Absen</button>
                                </div>
                                <div class="col-6 col-md-2">
                                    <button class="btn btn-gradient-danger btn-sm w-100" onclick="triggerPrint('docJurnal', 'Jurnal')">Cetak</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div id="areaAbsen" class="modern-card d-none mb-3">
                        <div class="card-header-gradient card-header-success">
                            <i class="bi bi-people me-2"></i>Daftar Hadir
                        </div>
                        <div class="card-body p-3">
                            <div id="listSiswaAbsen" class="row g-2"></div>
                            <button class="btn btn-gradient-primary btn-sm mt-3" onclick="simpanJurnal()">
                                <i class="bi bi-save me-1"></i>Simpan Jurnal
                            </button>
                        </div>
                    </div>
                </div>
                
                <div id="docJurnal" class="document-page print-view d-none">
                    <div class="doc-header">JURNAL PELAKSANAAN PEMBELAJARAN</div>
                    <table class="identity-table" style="width: 50%;">
                        <tr><td width="30%">Nama Sekolah</td><td>:</td><td class="vSekolah fw-bold"></td></tr>
                        <tr><td>Mata Pelajaran</td><td>:</td><td class="vMapel"></td></tr>
                        <tr><td>Nama Guru</td><td>:</td><td class="vGuru"></td></tr>
                    </table>
                    <table class="doc-table mt-2 text-center">
                        <thead><tr><th width="15%">Hari/Tgl</th><th width="10%">Rombel</th><th width="35%">Materi</th><th width="20%">Absensi</th><th width="20%">Catatan</th></tr></thead>
                        <tbody>
                            <tr><td id="jurTanggal"></td><td id="jurRombel"></td><td id="jurMateri" class="text-start"></td>
                                <td class="text-start">Hadir: <span id="jurHadir">0</span><br>Absen: <span id="jurAbsen">0</span><br><div id="jurListAbsen" class="small"></div></td>
                                <td>Tuntas</td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="signature-area mt-4">
                        <div class="signature-box">Kepala Sekolah<div class="signature-name vKepsek"></div></div>
                        <div class="signature-box">Guru <span class="vMapel"></span><div class="signature-name vGuru"></div></div>
                    </div>
                </div>
            </div>

            <!-- Penilaian (Premium) -->
            <div id="tabPenilaian" class="tab-content d-none animate-fadeIn">
                <div class="no-print">
                    <h4 class="fw-bold mb-4"><i class="bi bi-graph-up me-2"></i>Rekap Penilaian</h4>
                    
                    <div class="modern-card mb-3">
                        <div class="card-body p-3">
                            <div class="row g-2 align-items-end">
                                <div class="col-12 col-md-4">
                                    <label class="form-label small fw-bold">Rombel</label>
                                    <select id="selectKelasNilai" class="form-select form-select-sm" onchange="loadPenilaian()"></select>
                                </div>
                                <div class="col-12 col-md-4">
                                    <label class="form-label small fw-bold">Topik</label>
                                    <input type="text" id="topikNilai" class="form-control form-control-sm" value="Ulangan Harian">
                                </div>
                                <div class="col-6 col-md-2">
                                    <button class="btn btn-gradient-success btn-sm w-100" onclick="simpanNilai()">Simpan</button>
                                </div>
                                <div class="col-6 col-md-2">
                                    <button class="btn btn-gradient-danger btn-sm w-100" onclick="triggerPrint('docNilai', 'Nilai')">Cetak</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="docNilai" class="document-page print-view d-none">
                    <div class="doc-header">REKAPITULASI NILAI SISWA</div>
                    <table class="identity-table" style="width: 60%;">
                        <tr><td width="25%">Mata Pelajaran</td><td>:</td><td class="vMapel"></td></tr>
                        <tr><td>Rombel</td><td>:</td><td><b id="lblKelasNilai">...</b></td></tr>
                        <tr><td>Topik</td><td>:</td><td><b id="lblTopikNilai">...</b></td></tr>
                    </table>
                    <table class="doc-table mt-3 text-center">
                        <thead><tr><th width="5%">No</th><th width="15%">NISN</th><th class="text-start">Nama Siswa</th><th width="10%">JK</th><th width="15%">Nilai</th></tr></thead>
                        <tbody id="tblNilaiBody"><tr><td colspan="5">Pilih Rombel.</td></tr></tbody>
                    </table>
                    <div class="signature-area">
                        <div class="signature-box">Kepala Sekolah<div class="signature-name vKepsek"></div></div>
                        <div class="signature-box">Guru <span class="vMapel"></span><div class="signature-name vGuru"></div></div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
