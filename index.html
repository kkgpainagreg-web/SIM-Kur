<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIM Kurikulum Merdeka Pro</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="data_default.js"></script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --danger-gradient: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
            --warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --info-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --dark-bg: #1a1a2e;
            --sidebar-bg: linear-gradient(180deg, #16213e 0%, #0f3460 100%);
            --card-shadow: 0 10px 40px rgba(0,0,0,0.1);
            --hover-transform: translateY(-5px);
        }
        
        * { font-family: 'Poppins', sans-serif; }
        
        body { 
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Sidebar Styles - SCROLLABLE */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            width: 280px;
            height: 100vh;
            background: var(--sidebar-bg);
            color: white;
            padding: 0;
            box-shadow: 5px 0 30px rgba(0,0,0,0.2);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .sidebar-header {
            padding: 20px;
            text-align: center;
            background: rgba(255,255,255,0.1);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            flex-shrink: 0;
        }
        
        .sidebar-header .logo-circle {
            width: 70px;
            height: 70px;
            background: var(--primary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 10px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }
        
        .sidebar-header .logo-circle i { font-size: 30px; color: white; }
        
        .sidebar-nav-wrapper {
            flex: 1;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 10px 0;
        }
        
        .sidebar-nav-wrapper::-webkit-scrollbar { width: 6px; }
        .sidebar-nav-wrapper::-webkit-scrollbar-track { background: rgba(255,255,255,0.1); }
        .sidebar-nav-wrapper::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.3); border-radius: 3px; }
        .sidebar-nav-wrapper::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.5); }
        
        .sidebar .nav-link {
            color: rgba(255,255,255,0.7);
            padding: 12px 20px;
            margin: 3px 12px;
            border-radius: 10px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
            font-size: 0.85rem;
            white-space: nowrap;
            cursor: pointer;
        }
        
        .sidebar .nav-link:hover {
            color: white;
            background: rgba(255,255,255,0.15);
            transform: translateX(5px);
        }
        
        .sidebar .nav-link.active {
            background: var(--primary-gradient);
            color: white;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        .sidebar .nav-link i { width: 22px; text-align: center; font-size: 1rem; flex-shrink: 0; }
        .sidebar .nav-link span { flex: 1; overflow: hidden; text-overflow: ellipsis; }
        
        .nav-section-title {
            padding: 10px 20px 5px;
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: rgba(255,255,255,0.4);
            font-weight: 600;
        }
        
        .sidebar .nav-divider {
            border-top: 1px solid rgba(255,255,255,0.1);
            margin: 10px 20px;
        }
        
        .premium-badge {
            background: var(--warning-gradient);
            color: white;
            padding: 2px 6px;
            border-radius: 20px;
            font-size: 0.6rem;
            font-weight: 600;
            flex-shrink: 0;
        }
        
        .free-badge {
            background: var(--secondary-gradient);
            color: white;
            padding: 2px 6px;
            border-radius: 20px;
            font-size: 0.6rem;
            font-weight: 600;
            flex-shrink: 0;
        }
        
        .sidebar-footer {
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-top: 1px solid rgba(255,255,255,0.1);
            flex-shrink: 0;
        }
        
        .sidebar-footer .status-box {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 10px;
            font-size: 0.8rem;
        }
        
        .main-content {
            margin-left: 280px;
            padding: 25px;
            min-height: 100vh;
        }
        
        /* Cards */
        .modern-card {
            background: white;
            border-radius: 20px;
            box-shadow: var(--card-shadow);
            border: none;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .modern-card:hover {
            transform: var(--hover-transform);
            box-shadow: 0 20px 60px rgba(0,0,0,0.15);
        }
        
        .modern-card .card-header {
            background: var(--primary-gradient);
            color: white;
            padding: 18px 22px;
            border: none;
            font-weight: 600;
        }
        
        .modern-card .card-body { padding: 22px; }
        
        /* Stats Cards */
        .stat-card {
            background: white;
            border-radius: 20px;
            padding: 22px;
            box-shadow: var(--card-shadow);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            transform: translate(30%, -30%);
            opacity: 0.1;
        }
        
        .stat-card.primary::before { background: #667eea; }
        .stat-card.success::before { background: #11998e; }
        .stat-card.warning::before { background: #f093fb; }
        .stat-card.danger::before { background: #ff416c; }
        
        .stat-card:hover { transform: var(--hover-transform); }
        
        .stat-card .stat-icon {
            width: 55px;
            height: 55px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            color: white;
        }
        
        .stat-card.primary .stat-icon { background: var(--primary-gradient); }
        .stat-card.success .stat-icon { background: var(--secondary-gradient); }
        .stat-card.warning .stat-icon { background: var(--warning-gradient); }
        .stat-card.danger .stat-icon { background: var(--danger-gradient); }
        
        /* Buttons */
        .btn-gradient-primary {
            background: var(--primary-gradient);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.3);
        }
        
        .btn-gradient-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            color: white;
        }
        
        .btn-gradient-success {
            background: var(--secondary-gradient);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(17, 153, 142, 0.3);
        }
        
        .btn-gradient-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(17, 153, 142, 0.4);
            color: white;
        }
        
        .btn-gradient-danger {
            background: var(--danger-gradient);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-gradient-warning {
            background: var(--warning-gradient);
            border: none;
            color: white;
            padding: 12px 25px;
            border-radius: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        /* Form Controls */
        .form-control, .form-select {
            border-radius: 10px;
            padding: 10px 15px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 4px rgba(102, 126, 234, 0.1);
        }
        
        /* Tables */
        .modern-table {
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--card-shadow);
        }
        
        .modern-table thead {
            background: var(--primary-gradient);
            color: white;
        }
        
        .modern-table thead th {
            padding: 15px 12px;
            font-weight: 600;
            border: none;
            font-size: 0.85rem;
        }
        
        .modern-table tbody td {
            padding: 12px;
            vertical-align: middle;
            border-bottom: 1px solid #f1f3f5;
            font-size: 0.9rem;
        }
        
        .modern-table tbody tr:hover { background: rgba(102, 126, 234, 0.05); }
        
        /* Calendar */
        .calendar-wrapper {
            background: white;
            border-radius: 20px;
            box-shadow: var(--card-shadow);
            overflow: hidden;
        }
        
        .calendar-header {
            background: var(--primary-gradient);
            color: white;
            padding: 18px;
            text-align: center;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            padding: 12px;
        }
        
        .calendar-day-header {
            text-align: center;
            font-weight: 600;
            color: #667eea;
            padding: 8px;
            font-size: 0.8rem;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            position: relative;
            font-size: 0.85rem;
        }
        
        .calendar-day:hover { background: rgba(102, 126, 234, 0.1); }
        .calendar-day.today { background: var(--primary-gradient); color: white; }
        .calendar-day.holiday { background: #ffe8e8; color: #ff4757; }
        .calendar-day.holiday-custom { background: #e8f5e9; color: #2e7d32; }
        .calendar-day .holiday-dot {
            width: 5px;
            height: 5px;
            border-radius: 50%;
            background: #ff4757;
            position: absolute;
            bottom: 4px;
        }
        
        /* Document Page */
        .document-page {
            background: white;
            padding: 50px;
            box-shadow: var(--card-shadow);
            border-radius: 15px;
            margin-bottom: 20px;
            font-family: 'Times New Roman', Times, serif;
            color: black;
        }
        
        .doc-header {
            text-align: center;
            font-weight: bold;
            font-size: 14pt;
            margin-bottom: 20px;
            text-transform: uppercase;
            line-height: 1.4;
        }
        
        table.doc-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 11pt;
            margin-bottom: 15px;
        }
        
        table.doc-table th, table.doc-table td {
            border: 1px solid black;
            padding: 10px;
            vertical-align: middle;
        }
        
        table.doc-table th {
            background-color: #f8f9fa;
            text-align: center;
            font-weight: bold;
        }
        
        /* Jenjang Badge */
        .jenjang-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .jenjang-paud { background: #fff3e0; color: #ef6c00; }
        .jenjang-sd { background: #e3f2fd; color: #1976d2; }
        .jenjang-smp { background: #f3e5f5; color: #7b1fa2; }
        .jenjang-sma { background: #e8f5e9; color: #388e3c; }
        .jenjang-smk { background: #fce4ec; color: #c2185b; }
        
        /* Mapel Card */
        .mapel-card {
            background: white;
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
            transition: all 0.3s ease;
            border: 2px solid transparent;
            cursor: pointer;
        }
        
        .mapel-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.12);
        }
        
        .mapel-card.active {
            border-color: #667eea;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.05) 0%, rgba(118, 75, 162, 0.05) 100%);
        }
        
        /* Conflict Badge */
        .conflict-badge {
            background: var(--danger-gradient);
            color: white;
            padding: 3px 8px;
            border-radius: 5px;
            font-size: 0.7rem;
            font-weight: 600;
        }
        
        /* Jadwal Matrix */
        .jadwal-matrix {
            overflow-x: auto;
        }
        
        .jadwal-matrix table {
            min-width: 800px;
        }
        
        .jadwal-cell {
            min-height: 60px;
            padding: 8px;
            font-size: 0.75rem;
            vertical-align: top;
        }
        
        .jadwal-item {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 5px 8px;
            border-radius: 8px;
            margin-bottom: 4px;
            font-size: 0.7rem;
        }
        
        /* Upgrade Banner */
        .upgrade-banner {
            background: var(--warning-gradient);
            color: white;
            padding: 15px 20px;
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(240, 147, 251, 0.3);
        }
        
        .upgrade-banner .btn {
            background: white;
            color: #f093fb;
            font-weight: 600;
        }
        
        /* WhatsApp Button */
        .btn-whatsapp {
            background: #25D366;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(37, 211, 102, 0.4);
        }
        
        .btn-whatsapp:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(37, 211, 102, 0.5);
            color: white;
        }
        
        /* Active Mapel Indicator */
        .active-mapel-indicator {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1) 0%, rgba(118, 75, 162, 0.1) 100%);
            border: 2px solid #667eea;
            border-radius: 12px;
            padding: 12px 15px;
            margin-bottom: 15px;
        }
        
        /* Mobile Toggle */
        .mobile-toggle {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1001;
            background: var(--primary-gradient);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        /* Info Box */
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 12px 15px;
            border-radius: 0 10px 10px 0;
            margin-bottom: 15px;
        }
        
        .info-box.warning {
            background: #fff3e0;
            border-left-color: #ff9800;
        }
        
        .info-box.danger {
            background: #ffebee;
            border-left-color: #f44336;
        }
        
        /* Animations */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in { animation: fadeInUp 0.5s ease forwards; }
        
        /* Mobile Responsive */
        @media (max-width: 992px) {
            .sidebar { transform: translateX(-100%); transition: transform 0.3s ease; }
            .sidebar.show { transform: translateX(0); }
            .main-content { margin-left: 0; padding: 70px 15px 15px; }
            .mobile-toggle { display: flex; align-items: center; justify-content: center; }
            .sidebar-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 999; }
            .sidebar-overlay.show { display: block; }
        }
        
        /* Print Styles */
        @media print {
            @page { margin: 15mm; }
            body { background: white !important; }
            .no-print, .sidebar, .mobile-toggle, .sidebar-overlay { display: none !important; }
            .main-content { margin-left: 0 !important; padding: 0 !important; }
            .document-page { box-shadow: none !important; margin: 0 !important; border-radius: 0 !important; }
            .print-active { display: block !important; }
        }
    </style>
</head>
<body>

    <!-- Mobile Toggle -->
    <button class="mobile-toggle no-print" onclick="toggleSidebar()">
        <i class="fas fa-bars"></i>
    </button>
    
    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay no-print" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <!-- Admin Login Modal -->
    <div class="modal fade" id="adminLoginModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="border-radius: 25px; border: none;">
                <div class="modal-body p-5">
                    <div class="text-center mb-4">
                        <div class="logo-circle mx-auto mb-3" style="width: 80px; height: 80px; background: var(--primary-gradient); border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                            <i class="fas fa-user-shield fa-2x text-white"></i>
                        </div>
                        <h4 class="fw-bold">Admin Login</h4>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Email Admin</label>
                        <input type="email" id="adminEmail" class="form-control" placeholder="admin@email.com">
                    </div>
                    <div class="mb-4">
                        <label class="form-label fw-semibold">Password</label>
                        <input type="password" id="adminPassword" class="form-control" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢">
                    </div>
                    <button class="btn btn-gradient-primary w-100" onclick="loginAdmin()">
                        <i class="fas fa-sign-in-alt me-2"></i>Login
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Premium Upgrade Modal -->
    <div class="modal fade" id="upgradeModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content" style="border-radius: 25px; border: none; overflow: hidden;">
                <div class="modal-header text-white" style="background: var(--warning-gradient); border: none; padding: 25px;">
                    <div>
                        <h4 class="mb-1 fw-bold"><i class="fas fa-crown me-2"></i>Upgrade ke Premium</h4>
                        <p class="mb-0 opacity-75">Akses semua fitur tanpa batas!</p>
                    </div>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
               <div class="modal-body p-4">
    <div class="mb-3">
        <label class="form-label fw-semibold">Jenjang Sekolah <span class="text-danger">*</span></label>
        <select id="newMapelJenjang" class="form-select" onchange="updateMapelFormByJenjang()">
            <option value="">-- Pilih Jenjang --</option>
            <option value="PAUD">PAUD / TK</option>
            <option value="SD">SD / MI</option>
            <option value="SMP">SMP / MTs</option>
            <option value="SMA">SMA / MA</option>
            <option value="SMK">SMK</option>
        </select>
    </div>
    <div class="mb-3">
        <label class="form-label fw-semibold">Nama Mata Pelajaran <span class="text-danger">*</span></label>
        <input type="text" id="newMapelNama" class="form-control" placeholder="Contoh: Matematika">
    </div>
    <div class="row g-3">
        <div class="col-md-6">
            <label class="form-label fw-semibold">Kelas <span class="text-danger">*</span></label>
            <select id="newMapelKelas" class="form-select" disabled onchange="updateMapelFaseByKelas()">
                <option value="">Pilih Jenjang Dulu</option>
            </select>
            <input type="hidden" id="newMapelFase" value="">
        </div>
        <div class="col-md-6">
            <label class="form-label fw-semibold">Fase (Auto)</label>
            <div class="form-control bg-light" id="newMapelFaseDisplay">-</div>
        </div>
    </div>
    <button class="btn btn-gradient-success w-100 mt-4" onclick="simpanMapelBaru()">
        <i class="fas fa-save me-2"></i>Simpan Mata Pelajaran
    </button>
</div>
                        <div class="col-md-6">
                            <div class="p-4 rounded-4" style="background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);">
                                <h5 class="fw-bold mb-3"><i class="fas fa-crown text-warning me-2"></i>Fitur PREMIUM</h5>
                                <ul class="list-unstyled mb-0">
                                    <li class="mb-2"><i class="fas fa-star text-warning me-2"></i>Program Semester</li>
                                    <li class="mb-2"><i class="fas fa-star text-warning me-2"></i>Modul Ajar</li>
                                    <li class="mb-2"><i class="fas fa-star text-warning me-2"></i>Absensi & Jurnal</li>
                                    <li class="mb-2"><i class="fas fa-star text-warning me-2"></i>Rekap Penilaian</li>
                                    <li class="mb-2"><i class="fas fa-star text-warning me-2"></i>Import Siswa</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4 p-4 bg-light rounded-4">
                        <div class="row align-items-center">
                            <div class="col-md-6">
                                <h3 class="fw-bold mb-1" id="displayPrice">Rp 99.000</h3>
                                <p class="text-muted mb-0" id="displayPriceDesc">Lifetime</p>
                            </div>
                            <div class="col-md-6 text-md-end mt-3 mt-md-0">
                                <a href="#" id="waUpgradeBtn" class="btn btn-whatsapp" target="_blank">
                                    <i class="fab fa-whatsapp fa-lg"></i>WhatsApp
                                </a>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-4 p-4 border rounded-4">
                        <h6 class="fw-bold mb-3"><i class="fas fa-university me-2"></i>Transfer ke:</h6>
                        <p class="mb-1"><strong>Bank:</strong> <span id="displayBank">BCA</span> | <strong>No:</strong> <span id="displayRekening">1234567890</span> | <strong>A/N:</strong> <span id="displayNamaRek">Admin</span></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Mapel Modal -->
    <div class="modal fade" id="addMapelModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="border-radius: 20px; border: none;">
                <div class="modal-header" style="background: var(--secondary-gradient); color: white; border: none; border-radius: 20px 20px 0 0;">
                    <h5 class="modal-title"><i class="fas fa-plus-circle me-2"></i>Tambah Mata Pelajaran</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Jenjang Sekolah <span class="text-danger">*</span></label>
                        <select id="newMapelJenjang" class="form-select" onchange="updateMapelFormByJenjang()">
                            <option value="">-- Pilih Jenjang --</option>
                            <option value="PAUD">PAUD / TK</option>
                            <option value="SD">SD / MI</option>
                            <option value="SMP">SMP / MTs</option>
                            <option value="SMA">SMA / MA</option>
                            <option value="SMK">SMK</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-semibold">Nama Mata Pelajaran <span class="text-danger">*</span></label>
                        <input type="text" id="newMapelNama" class="form-control" placeholder="Contoh: Matematika">
                    </div>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Kelas <span class="text-danger">*</span></label>
                            <select id="newMapelKelas" class="form-select" disabled>
                                <option value="">Pilih Jenjang Dulu</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label fw-semibold">Fase <span class="text-danger">*</span></label>
                            <select id="newMapelFase" class="form-select" disabled>
                                <option value="">Pilih Jenjang Dulu</option>
                            </select>
                        </div>
                    </div>
                    <button class="btn btn-gradient-success w-100 mt-4" onclick="simpanMapelBaru()">
                        <i class="fas fa-save me-2"></i>Simpan Mata Pelajaran
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Jadwal Conflict Modal -->
    <div class="modal fade" id="jadwalConflictModal" tabindex="-1">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content" style="border-radius: 20px; border: none;">
                <div class="modal-header" style="background: var(--danger-gradient); color: white; border: none; border-radius: 20px 20px 0 0;">
                    <h5 class="modal-title"><i class="fas fa-exclamation-triangle me-2"></i>Jadwal Bentrok!</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-4">
                    <div id="conflictDetails"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="mainApp">
        <!-- Sidebar -->
        <div class="sidebar no-print" id="sidebarMenu">
            <div class="sidebar-header">
                <div class="logo-circle">
                    <i class="fas fa-graduation-cap"></i>
                </div>
                <h6 class="fw-bold mb-0">SIM Kurikulum</h6>
                <small class="opacity-75">Merdeka Pro v2.1</small>
            </div>
            
            <div class="sidebar-nav-wrapper">
                <nav class="nav flex-column">
                    <div class="nav-section-title">Menu Utama</div>
                    <a class="nav-link active" onclick="showTab('tabDashboard')">
                        <i class="fas fa-home"></i><span>Dashboard</span>
                    </a>
                    <a class="nav-link" onclick="showTab('tabMapel')">
                        <i class="fas fa-book-reader"></i><span>Mata Pelajaran</span>
                        <span class="free-badge">FREE</span>
                    </a>
                    <a class="nav-link" onclick="showTab('tabKalender')">
                        <i class="fas fa-calendar-alt"></i><span>Kalender</span>
                        <span class="free-badge">FREE</span>
                    </a>
                    
                    <div class="nav-section-title">Data & Profil</div>
                    <a class="nav-link" onclick="showTab('tabProfil')">
                        <i class="fas fa-school"></i><span>Profil Instansi</span>
                        <span class="free-badge">FREE</span>
                    </a>
                    <a class="nav-link" onclick="showTab('tabJadwal')">
                        <i class="fas fa-clock"></i><span>Jadwal Mengajar</span>
                        <span class="free-badge">FREE</span>
                    </a>
                    <a class="nav-link" onclick="showTab('tabSiswa')">
                        <i class="fas fa-users"></i><span>Data Siswa</span>
                        <span class="premium-badge">PRO</span>
                    </a>
                    
                    <div class="nav-section-title">Kurikulum</div>
                    <a class="nav-link" onclick="showTab('tabCPTP')">
                        <i class="fas fa-bullseye"></i><span>Setup CP & TP</span>
                        <span class="premium-badge">PRO</span>
                    </a>
                    <a class="nav-link" onclick="showTab('tabTahunan')">
                        <i class="fas fa-folder-open"></i><span>ATP, Prota, Promes</span>
                    </a>
                    <a class="nav-link" onclick="showTab('tabPerangkat')">
                        <i class="fas fa-book-open"></i><span>Modul Ajar</span>
                        <span class="premium-badge">PRO</span>
                    </a>
                    
                    <div class="nav-section-title">Pelaksanaan</div>
                    <a class="nav-link" onclick="showTab('tabPelaksanaan')">
                        <i class="fas fa-clipboard-list"></i><span>Absen & Jurnal</span>
                        <span class="premium-badge">PRO</span>
                    </a>
                    <a class="nav-link" onclick="showTab('tabPenilaian')">
                        <i class="fas fa-chart-bar"></i><span>Penilaian</span>
                        <span class="premium-badge">PRO</span>
                    </a>
                    
                    <div class="nav-section-title">Bantuan</div>
                    <a class="nav-link" onclick="showTab('tabPanduan')">
                        <i class="fas fa-book"></i><span>Panduan</span>
                    </a>
                    <a class="nav-link" onclick="showTab('tabAI')">
                        <i class="fas fa-robot"></i><span>Asisten AI</span>
                    </a>
                    
                    <div class="nav-divider"></div>
                    <a class="nav-link" onclick="showAdminLogin()">
                        <i class="fas fa-user-shield"></i><span>Admin Panel</span>
                    </a>
                </nav>
            </div>
            
            <div class="sidebar-footer">
                <div class="status-box">
                    <div class="d-flex justify-content-between align-items-center mb-1">
                        <small class="opacity-75">Status:</small>
                        <span id="userStatusBadge" class="badge bg-secondary" style="font-size: 0.65rem;">Free</span>
                    </div>
                    <small class="d-block opacity-50" style="font-size: 0.6rem;">ID: <span id="showDeviceId"></span></small>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content" id="mainContentArea">
            
            <!-- Dashboard -->
            <div id="tabDashboard" class="tab-content animate-fade-in">
                <h3 class="fw-bold mb-1">Dashboard ðŸ‘‹</h3>
                <p class="text-muted mb-4">SIM Kurikulum Merdeka - Semua Jenjang</p>
                
                <div class="active-mapel-indicator no-print" id="activeMapelIndicator" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <small class="text-muted">Mapel Aktif:</small>
                            <h6 class="mb-0 fw-bold" id="activeMapelName">-</h6>
                        </div>
                        <button class="btn btn-sm btn-outline-primary" onclick="showTab('tabMapel')">
                            <i class="fas fa-exchange-alt me-1"></i>Ganti
                        </button>
                    </div>
                </div>
                
                <div class="upgrade-banner no-print" id="upgradeBanner">
                    <div>
                        <h6 class="mb-0 fw-bold"><i class="fas fa-crown me-2"></i>Upgrade ke Premium!</h6>
                        <small class="opacity-75">Akses semua fitur</small>
                    </div>
                    <button class="btn btn-sm" onclick="showUpgradeModal()">Lihat</button>
                </div>
                
                <div class="row g-3 mb-4">
                    <div class="col-6 col-md-3">
                        <div class="stat-card primary">
                            <div class="d-flex align-items-center">
                                <div class="stat-icon me-3"><i class="fas fa-book-reader"></i></div>
                                <div>
                                    <h4 class="mb-0 fw-bold" id="statMapel">0</h4>
                                    <small class="text-muted">Mapel</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stat-card success">
                            <div class="d-flex align-items-center">
                                <div class="stat-icon me-3"><i class="fas fa-users"></i></div>
                                <div>
                                    <h4 class="mb-0 fw-bold" id="statSiswa">0</h4>
                                    <small class="text-muted">Siswa</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stat-card warning">
                            <div class="d-flex align-items-center">
                                <div class="stat-icon me-3"><i class="fas fa-calendar-check"></i></div>
                                <div>
                                    <h4 class="mb-0 fw-bold" id="statJadwal">0</h4>
                                    <small class="text-muted">Jadwal</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6 col-md-3">
                        <div class="stat-card danger">
                            <div class="d-flex align-items-center">
                                <div class="stat-icon me-3"><i class="fas fa-bullseye"></i></div>
                                <div>
                                    <h4 class="mb-0 fw-bold" id="statTP">0</h4>
                                    <small class="text-muted">TP</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="modern-card h-100">
                            <div class="card-header"><i class="fas fa-rocket me-2"></i>Aksi Cepat</div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-6 col-md-3">
                                        <button class="btn btn-outline-primary w-100 py-3" onclick="showTab('tabMapel')">
                                            <i class="fas fa-plus d-block mb-2"></i><small>Mapel</small>
                                        </button>
                                    </div>
                                    <div class="col-6 col-md-3">
                                        <button class="btn btn-outline-success w-100 py-3" onclick="showTab('tabJadwal')">
                                            <i class="fas fa-clock d-block mb-2"></i><small>Jadwal</small>
                                        </button>
                                    </div>
                                    <div class="col-6 col-md-3">
                                        <button class="btn btn-outline-warning w-100 py-3" onclick="showTab('tabKalender')">
                                            <i class="fas fa-calendar d-block mb-2"></i><small>Kalender</small>
                                        </button>
                                    </div>
                                    <div class="col-6 col-md-3">
                                        <button class="btn btn-outline-danger w-100 py-3" onclick="showTab('tabTahunan')">
                                            <i class="fas fa-file-alt d-block mb-2"></i><small>ATP</small>
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="modern-card h-100">
                            <div class="card-header" style="background: var(--secondary-gradient);">
                                <i class="fas fa-info-circle me-2"></i>Info
                            </div>
                            <div class="card-body">
                                <p class="mb-2"><strong>Versi:</strong> 2.1</p>
                                <p class="mb-2"><strong>Jenjang:</strong></p>
                                <div class="d-flex flex-wrap gap-1">
                                    <span class="jenjang-badge jenjang-paud">PAUD</span>
                                    <span class="jenjang-badge jenjang-sd">SD</span>
                                    <span class="jenjang-badge jenjang-smp">SMP</span>
                                    <span class="jenjang-badge jenjang-sma">SMA</span>
                                    <span class="jenjang-badge jenjang-smk">SMK</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mapel Tab -->
            <div id="tabMapel" class="tab-content d-none animate-fade-in">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h3 class="fw-bold mb-1"><i class="fas fa-book-reader me-2 text-primary"></i>Mata Pelajaran</h3>
                        <p class="text-muted mb-0">Kelola mata pelajaran yang diampu</p>
                    </div>
                    <div>
                        <span class="badge bg-success px-3 py-2 me-2">GRATIS</span>
                        <button class="btn btn-gradient-primary" onclick="showAddMapelModal()">
                            <i class="fas fa-plus me-2"></i>Tambah
                        </button>
                    </div>
                </div>
                
                <div class="mb-4">
                    <div class="btn-group flex-wrap" role="group" id="filterJenjangBtns">
                        <button type="button" class="btn btn-outline-primary active" onclick="filterMapelByJenjang('ALL')">Semua</button>
                        <button type="button" class="btn btn-outline-primary" onclick="filterMapelByJenjang('PAUD')">PAUD</button>
                        <button type="button" class="btn btn-outline-primary" onclick="filterMapelByJenjang('SD')">SD</button>
                        <button type="button" class="btn btn-outline-primary" onclick="filterMapelByJenjang('SMP')">SMP</button>
                        <button type="button" class="btn btn-outline-primary" onclick="filterMapelByJenjang('SMA')">SMA</button>
                        <button type="button" class="btn btn-outline-primary" onclick="filterMapelByJenjang('SMK')">SMK</button>
                    </div>
                </div>
                
                <div class="row g-3" id="mapelList"></div>
            </div>

            <!-- Calendar Tab -->
            <div id="tabKalender" class="tab-content d-none animate-fade-in">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h3 class="fw-bold mb-1"><i class="fas fa-calendar-alt me-2 text-primary"></i>Kalender Akademik</h3>
                        <p class="text-muted mb-0">Hari libur nasional & kustom</p>
                    </div>
                    <span class="badge bg-success px-3 py-2">GRATIS</span>
                </div>
                
                <div class="row g-4">
                    <div class="col-lg-8">
                        <div class="calendar-wrapper">
                            <div class="calendar-header d-flex justify-content-between align-items-center">
                                <button class="btn btn-light btn-sm" onclick="changeMonth(-1)"><i class="fas fa-chevron-left"></i></button>
                                <h5 class="mb-0 fw-bold" id="calendarTitle">Juli 2025</h5>
                                <button class="btn btn-light btn-sm" onclick="changeMonth(1)"><i class="fas fa-chevron-right"></i></button>
                            </div>
                            <div class="calendar-grid" id="calendarGrid"></div>
                        </div>
                        <div class="mt-3 p-3 bg-white rounded-4 shadow-sm d-flex gap-4 flex-wrap">
                            <div><span class="badge me-2" style="background: var(--primary-gradient);">&nbsp;&nbsp;</span>Hari Ini</div>
                            <div><span class="badge bg-danger me-2">&nbsp;&nbsp;</span>Libur Nasional</div>
                            <div><span class="badge bg-success me-2">&nbsp;&nbsp;</span>Libur Kustom</div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="modern-card mb-4">
                            <div class="card-header" style="background: var(--secondary-gradient);">
                                <i class="fas fa-plus-circle me-2"></i>Tambah Libur Kustom
                            </div>
                            <div class="card-body">
                                <p class="small text-muted mb-3">Untuk Idul Fitri, Idul Adha, dll.</p>
                                <div class="mb-3">
                                    <input type="date" id="customHolidayDate" class="form-control">
                                </div>
                                <div class="mb-3">
                                    <input type="text" id="customHolidayName" class="form-control" placeholder="Nama Hari Libur">
                                </div>
                                <button class="btn btn-gradient-success w-100" onclick="addCustomHoliday()">
                                    <i class="fas fa-plus me-2"></i>Tambah
                                </button>
                            </div>
                        </div>
                        <div class="modern-card">
                            <div class="card-header" style="background: var(--danger-gradient);">
                                <i class="fas fa-list me-2"></i>Daftar Libur
                            </div>
                            <div class="card-body p-0" style="max-height: 300px; overflow-y: auto;">
                                <div id="holidayList" class="p-3"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Tab -->
            <div id="tabProfil" class="tab-content d-none no-print animate-fade-in">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="fw-bold mb-0"><i class="fas fa-school me-2 text-warning"></i>Profil & Instansi</h3>
                    <span class="badge bg-success px-3 py-2">GRATIS</span>
                </div>
                
                <div class="modern-card">
                    <div class="card-header" style="background: var(--warning-gradient);">
                        <i class="fas fa-edit me-2"></i>Data Profil
                    </div>
                    <div class="card-body">
                        <div class="row g-3">
                            <div class="col-md-4">
                                <label class="form-label fw-semibold small">Jenjang Sekolah</label>
                                <select id="profJenjang" class="form-select" onchange="updateProfilByJenjang()">
                                    <option value="PAUD">PAUD / TK</option>
                                    <option value="SD" selected>SD / MI</option>
                                    <option value="SMP">SMP / MTs</option>
                                    <option value="SMA">SMA / MA</option>
                                    <option value="SMK">SMK</option>
                                </select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-semibold small">NPSN</label>
                                <input type="number" id="profNpsn" class="form-control" placeholder="12345678">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-semibold small">Nama Sekolah</label>
                                <input type="text" id="profSekolah" class="form-control" placeholder="SDN 1 ...">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold small">Alamat</label>
                                <input type="text" id="profAlamat" class="form-control" placeholder="Jl. ...">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold small">Tahun Ajaran</label>
                                <input type="text" id="profTahun" class="form-control" value="2025/2026">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold small">Kepala Sekolah</label>
                                <input type="text" id="profKepsek" class="form-control">
                            </div>
                            <div class="col-md-6">
                                <label class="form-label fw-semibold small">NIP Kepsek</label>
                                <input type="text" id="profNipKepsek" class="form-control">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-semibold small">Nama Guru</label>
                                <input type="text" id="profGuru" class="form-control">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-semibold small">NIP Guru</label>
                                <input type="text" id="profNipGuru" class="form-control">
                            </div>
                            <div class="col-md-4">
                                <label class="form-label fw-semibold small">Tempat, Tanggal</label>
                                <input type="text" id="profTanggal" class="form-control" placeholder="Jakarta, 15 Juli 2025">
                            </div>
                            <div class="col-12">
                                <button class="btn btn-gradient-warning" onclick="simpanProfil()">
                                    <i class="fas fa-save me-2"></i>Simpan Profil
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Schedule Tab with Validation -->
            <div id="tabJadwal" class="tab-content d-none no-print animate-fade-in">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="fw-bold mb-0"><i class="fas fa-clock me-2 text-success"></i>Jadwal Mengajar</h3>
                    <span class="badge bg-success px-3 py-2">GRATIS</span>
                </div>
                
                <div class="info-box mb-4">
                    <i class="fas fa-info-circle me-2"></i>
                    <strong>Validasi Anti Bentrok:</strong> Sistem akan memvalidasi agar tidak ada jadwal yang bentrok. Maksimal 2 rombel per jam pelajaran.
                </div>
                
                <div class="modern-card mb-4">
                    <div class="card-header" style="background: var(--secondary-gradient);">
                        <i class="fas fa-plus-circle me-2"></i>Tambah Jadwal
                    </div>
                    <div class="card-body">
                       <div class="row g-3 align-items-end">
    <div class="col-md-2 col-6">
        <label class="form-label fw-semibold small">Hari</label>
        <select id="jadwalHari" class="form-select">
            <option>Senin</option>
            <option>Selasa</option>
            <option>Rabu</option>
            <option>Kamis</option>
            <option>Jumat</option>
            <option>Sabtu</option>
        </select>
    </div>
    <div class="col-md-2 col-6">
        <label class="form-label fw-semibold small">Jam Ke</label>
        <select id="jadwalJam" class="form-select">
            <option value="1">Jam 1</option>
            <option value="2">Jam 2</option>
            <option value="3">Jam 3</option>
            <option value="4">Jam 4</option>
            <option value="5">Jam 5</option>
            <option value="6">Jam 6</option>
            <option value="7">Jam 7</option>
            <option value="8">Jam 8</option>
        </select>
    </div>
    <div class="col-md-2 col-6">
        <label class="form-label fw-semibold small">Jenjang</label>
        <select id="jadwalJenjang" class="form-select" onchange="updateJadwalDropdowns()">
            <option value="">Pilih</option>
            <option value="PAUD">PAUD</option>
            <option value="SD">SD</option>
            <option value="SMP">SMP</option>
            <option value="SMA">SMA</option>
            <option value="SMK">SMK</option>
        </select>
    </div>
    <div class="col-md-2 col-6">
        <label class="form-label fw-semibold small">Kelas</label>
        <select id="jadwalKelas" class="form-select" disabled onchange="updateJadwalFaseByKelas()">
            <option value="">Pilih Jenjang</option>
        </select>
        <input type="hidden" id="jadwalFase" value="">
    </div>
    <div class="col-md-2 col-6">
        <label class="form-label fw-semibold small">Fase (Auto)</label>
        <div class="form-control bg-light" id="jadwalFaseDisplay">-</div>
    </div>
    <div class="col-md-2 col-6">
        <label class="form-label fw-semibold small">Rombel</label>
        <input type="text" id="jadwalRombel" class="form-control" placeholder="A/B/C">
    </div>
</div>                
                <!-- Jadwal Matrix View -->
                <div id="jadwalMatrixView" class="modern-card mb-4 d-none">
                    <div class="card-header" style="background: var(--info-gradient);">
                        <i class="fas fa-table me-2"></i>Matriks Jadwal Mingguan
                    </div>
                    <div class="card-body jadwal-matrix">
                        <table class="table table-bordered table-sm" id="jadwalMatrixTable"></table>
                    </div>
                </div>
                
                <!-- Jadwal List -->
                <div class="modern-table">
    <table class="table table-hover mb-0">
        <thead>
            <tr>
                <th>Hari</th>
                <th>Jam</th>
                <th>Jenjang</th>
                <th>Kelas</th>
                <th>Fase</th>
                <th width="80">Aksi</th>
            </tr>
        </thead>
        <tbody id="tabelJadwalBody">
            <tr><td colspan="6" class="text-center py-4">Belum ada jadwal</td></tr>
        </tbody>
    </table>
</div>
            <!-- CP & TP Tab -->
            <div id="tabCPTP" class="tab-content d-none no-print animate-fade-in">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="fw-bold mb-0"><i class="fas fa-bullseye me-2 text-info"></i>Setup CP & TP</h3>
                    <span class="badge bg-warning px-3 py-2">PREMIUM</span>
                </div>
                
                <div id="cptpContent">
                    <div class="modern-card mb-4">
                        <div class="card-header" style="background: var(--info-gradient);">
                            <i class="fas fa-download me-2"></i>Load Default PAI SD
                        </div>
                        <div class="card-body">
                            <div class="row g-3 align-items-end">
                                <div class="col-md-4">
                                    <select id="loadDefaultKls" class="form-select">
                                        <option value="1">Kelas 1</option>
                                        <option value="2">Kelas 2</option>
                                        <option value="3">Kelas 3</option>
                                        <option value="4">Kelas 4</option>
                                        <option value="5">Kelas 5</option>
                                        <option value="6">Kelas 6</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <button class="btn btn-gradient-primary w-100" onclick="loadDefaultPAI()">
                                        <i class="fas fa-download me-2"></i>Load
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="modern-card">
                        <div class="card-header"><i class="fas fa-edit me-2"></i>Input CP & TP</div>
                        <div class="card-body">
                            <div class="mb-4">
                                <label class="form-label fw-bold">Capaian Pembelajaran (CP):</label>
                                <textarea id="inputCP" class="form-control" rows="3"></textarea>
                            </div>
                            <label class="form-label fw-bold mb-3">Tujuan Pembelajaran (TP):</label>
                            <div class="table-responsive">
                                <table class="table table-bordered">
                                    <thead class="table-light">
                                        <tr>
                                            <th width="10%">Bab</th>
                                            <th width="70%">Tujuan Pembelajaran</th>
                                            <th width="12%">JP</th>
                                            <th width="8%">Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody id="bodyInputTP"></tbody>
                                </table>
                            </div>
                            <div class="d-flex justify-content-between mt-3">
                                <button class="btn btn-outline-primary" onclick="tambahBarisTP()">
                                    <i class="fas fa-plus me-2"></i>Tambah Bab
                                </button>
                                <button class="btn btn-gradient-primary" onclick="simpanCPTP()">
                                    <i class="fas fa-save me-2"></i>Simpan
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Students Tab -->
            <div id="tabSiswa" class="tab-content d-none no-print animate-fade-in">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="fw-bold mb-0"><i class="fas fa-users me-2 text-primary"></i>Data Siswa</h3>
                    <span class="badge bg-warning px-3 py-2">PREMIUM</span>
                </div>
                
                <div class="info-box mb-4">
                    <strong>Format CSV:</strong> <code>nisn, nama, jk, kelas, rombel</code>
                </div>
                
                <div class="modern-card mb-4">
                    <div class="card-header"><i class="fas fa-file-csv me-2"></i>Upload CSV</div>
                    <div class="card-body">
                        <div class="row g-3 align-items-end">
                            <div class="col-md-8">
                                <input type="file" id="fileCsvSiswa" class="form-control" accept=".csv">
                            </div>
                            <div class="col-md-4">
                                <button class="btn btn-gradient-primary w-100" onclick="importSiswaLokal()">
                                    <i class="fas fa-upload me-2"></i>Upload
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="d-flex justify-content-between mb-3">
                    <select id="filterKelasSiswa" class="form-select" style="width: 200px;" onchange="renderTabelSiswa()"></select>
                    <button class="btn btn-outline-danger btn-sm" onclick="clearDataSiswa()">
                        <i class="fas fa-trash me-1"></i>Hapus Semua
                    </button>
                </div>
                
                <div class="modern-table">
                    <table class="table table-hover mb-0">
                        <thead><tr><th>NISN</th><th>Nama</th><th>JK</th><th>Kelas</th><th>Rombel</th></tr></thead>
                        <tbody id="tabelSiswaBody"><tr><td colspan="5" class="text-center py-4">Belum ada data</td></tr></tbody>
                    </table>
                </div>
            </div>

            <!-- ATP, Prota, Promes Tab -->
            <div id="tabTahunan" class="tab-content d-none animate-fade-in">
                <div class="d-flex justify-content-between align-items-center mb-4 no-print">
                    <h3 class="fw-bold mb-0"><i class="fas fa-folder-open me-2 text-danger"></i>ATP, Prota & Promes</h3>
                </div>
                
                <div class="modern-card mb-4 no-print">
                    <div class="card-header" style="background: var(--danger-gradient);">
                        <i class="fas fa-cog me-2"></i>Pengaturan
                    </div>
                    <div class="card-body">
                        <div class="row g-3 align-items-end">
                            <div class="col-md-4">
                                <label class="form-label fw-semibold small">Fase & Rombel</label>
                                <select id="tFaseRombel" class="form-select"></select>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-gradient-primary w-100" onclick="generateTahunan()">
                                    <i class="fas fa-sync me-1"></i>Load
                                </button>
                            </div>
                            <div class="col-md-6 text-end">
                                <button class="btn btn-gradient-success me-1" onclick="triggerPrint('docATP', 'ATP', 'landscape')">
                                    <i class="fas fa-print me-1"></i>ATP
                                </button>
                                <button class="btn btn-gradient-success me-1" onclick="triggerPrint('docProta', 'Prota', 'portrait')">
                                    <i class="fas fa-print me-1"></i>Prota
                                </button>
                                <button class="btn btn-gradient-warning" onclick="checkPremiumAndPrint('docPromes', 'Promes', 'landscape')">
                                    <i class="fas fa-print me-1"></i>Promes
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="docATP" class="document-page print-view d-none"></div>
                <div id="docProta" class="document-page print-view d-none"></div>
                <div id="docPromes" class="document-page print-view d-none"></div>
            </div>

            <!-- Modul Tab -->
            <div id="tabPerangkat" class="tab-content d-none animate-fade-in">
                <div class="d-flex justify-content-between align-items-center mb-4 no-print">
                    <h3 class="fw-bold mb-0"><i class="fas fa-book-open me-2 text-success"></i>Modul Ajar</h3>
                    <span class="badge bg-warning px-3 py-2">PREMIUM</span>
                </div>
                
                <div class="modern-card mb-4 no-print">
                    <div class="card-header" style="background: var(--secondary-gradient);"><i class="fas fa-cog me-2"></i>Pengaturan</div>
                    <div class="card-body">
                        <div class="row g-3 align-items-end">
                            <div class="col-md-4">
                                <label class="form-label small">Jadwal</label>
                                <select id="pSelectJadwal" class="form-select"></select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label small">Materi (TP)</label>
                                <select id="pSelectTP" class="form-select"></select>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-gradient-success w-100" onclick="generateModul()">Buat</button>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-gradient-danger w-100" onclick="triggerPrint('docModul', 'Modul', 'portrait')">Cetak</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="docModul" class="document-page print-view d-none"></div>
            </div>

            <!-- Absen Tab -->
            <div id="tabPelaksanaan" class="tab-content d-none animate-fade-in">
                <div class="d-flex justify-content-between align-items-center mb-4 no-print">
                    <h3 class="fw-bold mb-0"><i class="fas fa-clipboard-list me-2 text-danger"></i>Absensi & Jurnal</h3>
                    <span class="badge bg-warning px-3 py-2">PREMIUM</span>
                </div>
                
                <div class="modern-card mb-4 no-print">
                    <div class="card-header" style="background: var(--danger-gradient);"><i class="fas fa-cog me-2"></i>Pengaturan</div>
                    <div class="card-body">
                        <div class="row g-3 align-items-end">
                            <div class="col-md-4">
                                <label class="form-label small">Jadwal</label>
                                <select id="selectJadwalAbsen" class="form-select"></select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label small">Materi</label>
                                <select id="selectTPAbsen" class="form-select"></select>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-gradient-danger w-100" onclick="loadAbsensi()">Mulai</button>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-outline-danger w-100" onclick="triggerPrint('docJurnal', 'Jurnal', 'landscape')">Cetak</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div id="areaAbsen" class="d-none no-print mb-4">
                    <div class="modern-card">
                        <div class="card-header"><i class="fas fa-users me-2"></i>Kehadiran</div>
                        <div class="card-body">
                            <div id="listSiswaAbsen" class="row g-2"></div>
                            <hr>
                            <button class="btn btn-gradient-primary" onclick="simpanJurnal()"><i class="fas fa-save me-2"></i>Simpan Jurnal</button>
                        </div>
                    </div>
                </div>
                <div id="docJurnal" class="document-page print-view d-none"></div>
            </div>

            <!-- Penilaian Tab -->
            <div id="tabPenilaian" class="tab-content d-none animate-fade-in">
                <div class="d-flex justify-content-between align-items-center mb-4 no-print">
                    <h3 class="fw-bold mb-0"><i class="fas fa-chart-bar me-2 text-info"></i>Penilaian</h3>
                    <span class="badge bg-warning px-3 py-2">PREMIUM</span>
                </div>
                
                <div class="modern-card mb-4 no-print">
                    <div class="card-header" style="background: var(--info-gradient);"><i class="fas fa-cog me-2"></i>Pengaturan</div>
                    <div class="card-body">
                        <div class="row g-3 align-items-end">
                            <div class="col-md-4">
                                <label class="form-label small">Rombel</label>
                                <select id="selectKelasNilai" class="form-select" onchange="loadPenilaian()"></select>
                            </div>
                            <div class="col-md-4">
                                <label class="form-label small">Topik</label>
                                <input type="text" id="topikNilai" class="form-control" value="Ulangan Harian">
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-gradient-primary w-100" onclick="simpanNilai()">Simpan</button>
                            </div>
                            <div class="col-md-2">
                                <button class="btn btn-gradient-danger w-100" onclick="triggerPrint('docNilai', 'Nilai', 'portrait')">Cetak</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="docNilai" class="document-page print-view d-none"></div>
            </div>

            <!-- Panduan Tab -->
            <div id="tabPanduan" class="tab-content d-none no-print animate-fade-in">
                <h3 class="fw-bold mb-4"><i class="fas fa-book me-2 text-success"></i>Panduan</h3>
                <div class="modern-card">
                    <div class="card-body">
                        <div class="accordion" id="accordionPanduan">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button" data-bs-toggle="collapse" data-bs-target="#p1">
                                        <i class="fas fa-book-reader me-2 text-primary"></i>Menambah Mata Pelajaran
                                    </button>
                                </h2>
                                <div id="p1" class="accordion-collapse collapse show" data-bs-parent="#accordionPanduan">
                                    <div class="accordion-body">
                                        <ol>
                                            <li>Buka menu <b>Mata Pelajaran</b></li>
                                            <li>Klik <b>Tambah</b></li>
                                            <li>Pilih <b>Jenjang</b> terlebih dahulu</li>
                                            <li>Sistem akan otomatis menampilkan Fase dan Kelas sesuai jenjang</li>
                                            <li>Isi nama mapel dan klik Simpan</li>
                                        </ol>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" data-bs-toggle="collapse" data-bs-target="#p2">
                                        <i class="fas fa-clock me-2 text-success"></i>Validasi Jadwal Anti Bentrok
                                    </button>
                                </h2>
                                <div id="p2" class="accordion-collapse collapse" data-bs-parent="#accordionPanduan">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>Sistem akan <b>memblokir</b> jika jadwal sama persis sudah ada</li>
                                            <li>Maksimal <b>2 rombel</b> per jam pelajaran yang sama</li>
                                            <li>Gunakan tombol <b>Lihat Matriks</b> untuk melihat jadwal mingguan</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" data-bs-toggle="collapse" data-bs-target="#p3">
                                        <i class="fas fa-calendar me-2 text-danger"></i>Kalender & Hari Libur
                                    </button>
                                </h2>
                                <div id="p3" class="accordion-collapse collapse" data-bs-parent="#accordionPanduan">
                                    <div class="accordion-body">
                                        <ul>
                                            <li>Libur nasional <b>baku</b> sudah otomatis</li>
                                            <li>Untuk Idul Fitri, Idul Adha, dll â†’ tambah manual di <b>Libur Kustom</b></li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AI Tab -->
            <div id="tabAI" class="tab-content d-none no-print animate-fade-in">
                <h3 class="fw-bold mb-4"><i class="fas fa-robot me-2 text-info"></i>Asisten AI</h3>
                <div class="row g-3">
                    <div class="col-md-6">
                        <div class="modern-card h-100">
                            <div class="card-header" style="background: var(--primary-gradient);"><i class="fas fa-users me-2"></i>Data Siswa CSV</div>
                            <div class="card-body">
                                <textarea id="prompt1" class="form-control mb-3" rows="3" readonly>Buatkan data siswa 20 orang format CSV: nisn,nama,jk,kelas,rombel untuk kelas 4A.</textarea>
                                <button class="btn btn-gradient-primary btn-sm w-100" onclick="copyToClipboard('prompt1')"><i class="fas fa-copy me-2"></i>Salin</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="modern-card h-100">
                            <div class="card-header" style="background: var(--secondary-gradient);"><i class="fas fa-bullseye me-2"></i>Menyusun TP</div>
                            <div class="card-body">
                                <textarea id="prompt2" class="form-control mb-3" rows="3" readonly>Saya Guru [MAPEL] Fase [X]. Buatkan TP per Bab untuk 1 Semester dalam tabel: Bab, Judul TP, Alokasi JP. Total 72 JP.</textarea>
                                <button class="btn btn-gradient-success btn-sm w-100" onclick="copyToClipboard('prompt2')"><i class="fas fa-copy me-2"></i>Salin</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Admin Tab -->
            <div id="tabAdmin" class="tab-content d-none no-print animate-fade-in">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <h3 class="fw-bold mb-0"><i class="fas fa-user-shield me-2 text-warning"></i>Admin Panel</h3>
                    <button class="btn btn-outline-danger" onclick="logoutAdmin()"><i class="fas fa-sign-out-alt me-2"></i>Logout</button>
                </div>
                
                <div class="row g-4">
                    <div class="col-md-6">
                        <div class="modern-card">
                            <div class="card-header" style="background: var(--warning-gradient);"><i class="fas fa-cog me-2"></i>Admin</div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label class="form-label small">Email</label>
                                    <input type="email" id="adminEmailSetting" class="form-control">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label small">Password Baru</label>
                                    <input type="password" id="adminPasswordSetting" class="form-control">
                                </div>
                                <button class="btn btn-gradient-warning w-100" onclick="simpanAdminSettings()"><i class="fas fa-save me-2"></i>Simpan</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="modern-card">
                            <div class="card-header" style="background: var(--secondary-gradient);"><i class="fab fa-whatsapp me-2"></i>WhatsApp & Harga</div>
                            <div class="card-body">
                                <div class="mb-2"><input type="text" id="settingWA" class="form-control" placeholder="628xxx"></div>
                                <div class="mb-2"><input type="number" id="settingHarga" class="form-control" placeholder="Harga"></div>
                                <div class="mb-2"><input type="text" id="settingHargaDesc" class="form-control" placeholder="Deskripsi"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="modern-card">
                            <div class="card-header" style="background: var(--primary-gradient);"><i class="fas fa-university me-2"></i>Rekening</div>
                            <div class="card-body">
                                <div class="row g-3">
                                    <div class="col-md-4"><input type="text" id="settingBank" class="form-control" placeholder="Bank"></div>
                                    <div class="col-md-4"><input type="text" id="settingRekening" class="form-control" placeholder="No Rek"></div>
                                    <div class="col-md-4"><input type="text" id="settingNamaRek" class="form-control" placeholder="Atas Nama"></div>
                                </div>
                                <button class="btn btn-gradient-primary w-100 mt-3" onclick="simpanPricingSettings()"><i class="fas fa-save me-2"></i>Simpan Semua</button>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="modern-card">
                            <div class="card-header" style="background: var(--danger-gradient);"><i class="fas fa-crown me-2"></i>User Premium</div>
                            <div class="card-body">
                                <div class="row g-3 mb-4">
                                    <div class="col-md-5"><input type="text" id="newPremiumUser" class="form-control" placeholder="Device ID"></div>
                                    <div class="col-md-3"><button class="btn btn-gradient-success w-100" onclick="addPremiumUser()"><i class="fas fa-plus me-1"></i>Tambah</button></div>
                                    <div class="col-md-4"><button class="btn btn-gradient-primary w-100" onclick="activateCurrentDevice()"><i class="fas fa-check me-1"></i>Aktifkan Ini</button></div>
                                </div>
                                <table class="table table-bordered table-sm">
                                    <thead class="table-light"><tr><th>No</th><th>ID</th><th>Aksi</th></tr></thead>
                                    <tbody id="premiumUsersList"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="app.js"></script>
</body>
</html>

